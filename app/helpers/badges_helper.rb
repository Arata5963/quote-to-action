# app/helpers/badges_helper.rb
module BadgesHelper
  def post_badge_tag(post, **opts)
    achievement_count = post.achievements.count
    
    svg_content = case achievement_count
                  when 0
                    # 0回: 空の星
                    '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>'.html_safe
                  when 1
                    # 1回: 人のシルエット
                    '<svg viewBox="0 0 512 512">
                      <path d="M473.078,460.594L473,460.188c-1.625-8.25-5.219-16.125-9.828-23.563c-3.469-5.594-7.547-10.938-11.953-15.969 c-6.625-7.563-13.984-14.406-21.25-20.125c-3.641-2.844-7.25-5.438-10.766-7.688c-3.391-2.141-6.688-4-9.859-5.469l-64.594-32.906 l-0.188-0.094c-1.734-0.781-3.594-2.063-5.422-3.75l-6.359-5.813l-6.594,5.781C320.047,342.563,316,333.453,316,329.563 c0-6.422-1.453-12.156,0.375-17.438c0,0,27.406-36.594,41.813-80.688c47.844-39.172,22.859-72.609,13.563-67.969l-4.953,18.516 c-0.031-13.266-1.438-25.953-4.047-37.859h12.281l-1.844-11.203L353.828,16.469l-5.016-2c-0.406-0.156-9.469-3.781-25.547-7.344 C307.203,3.531,284.141,0,255.719,0s-51.688,3.531-67.953,7.094c-16.25,3.594-25.5,7.188-25.891,7.344l-5.125,2l-20.281,127.688 h12.781c-2.609,11.906-4,24.594-4.063,37.844l-4.922-18.5c-9.313-4.641-34.297,28.797,13.547,67.969 c14.406,44.094,41.813,80.688,41.813,80.688c1.813,5.281,0.391,6.125,0.391,17.438c0,5.547-2.797,12.188-7.063,18.25l-6.609-5.781 l-6.359,6.313c-2.531,2.531-5.438,4.625-8.547,6.031l-0.234,0.109l-62.781,32.859c-5.531,2.594-11.672,6.156-18.031,10.625 c-9.703,6.813-19.906,15.656-28.563,26.063c-4.313,5.219-8.25,10.844-11.5,16.828c-3.234,5.984-5.797,12.375-7.266,19.109 l-0.109,0.5L33.359,512H256h222.641L473.078,460.594z M159.016,124.875l14.969-94.25c4.078-1.281,10.5-3.125,18.984-4.938 c15.063-3.25,36.547-6.438,62.75-6.438c26.813,0,48.484,3.344,63.375,6.656c7.438,1.656,13.172,3.297,17.016,4.5 c0.203,0.078,0.375,0.125,0.563,0.188l15.656,94.281H159.016z M256,492.75H54.813l3.141-29.063 c1.391-6.094,4.188-12.281,8.047-18.328c5.906-9.25,14.266-17.984,22.859-25.094c4.297-3.547,8.656-6.703,12.75-9.344 s7.953-4.766,11.156-6.234l0.219-0.094l62.891-32.906c2.375-1.125,4.609-2.438,6.703-3.891l76.578,67l73.969-64.734 c0.984,0.594,2,1.125,3.063,1.641l64.594,32.891l0.172,0.094c4.063,1.859,9.438,5.141,15.016,9.344 c8.375,6.313,17.359,14.781,24.453,23.719c3.563,4.469,6.641,9.063,8.984,13.531c2.297,4.328,3.859,8.516,4.625,12.266 l3.172,29.203H256z" fill="currentColor"/>
                    </svg>'.html_safe
                  when 2
                    # 2回: 炎
                    '<svg viewBox="0 0 24 24" fill="currentColor">
                      <path d="M12 23c-4.4 0-8-3.6-8-8 0-2.6 1.3-5 3.4-6.5.3-.2.7-.1.9.2.2.3.1.7-.2.9C6.4 10.8 5.3 12.8 5.3 15c0 3.7 3 6.7 6.7 6.7s6.7-3 6.7-6.7c0-1.8-.7-3.4-2-4.6-.3-.2-.3-.6-.1-.9.2-.3.6-.3.9-.1 1.6 1.5 2.5 3.6 2.5 5.6 0 4.4-3.6 8-8 8zm0-13c-.4 0-.7-.3-.7-.7V2.7c0-.4.3-.7.7-.7s.7.3.7.7v6.6c0 .4-.3.7-.7.7z"/>
                    </svg>'.html_safe
                  when 3
                    # 3回: トロフィー
                    '<svg viewBox="0 0 24 24" fill="currentColor">
                      <path d="M20 2H4v4c0 3.31 2.69 6 6 6h4c3.31 0 6-2.69 6-6V2zm-8 16c-2.21 0-4 1.79-4 4h8c0-2.21-1.79-4-4-4zm-2-2v-2.17c-2.83-.65-5-3.15-5-6.16V6h14v1.67c0 3.01-2.17 5.51-5 6.16V16h-4z"/>
                    </svg>'.html_safe
                  else
                    # 4回以上: 王冠
                    '<svg viewBox="0 0 24 24" fill="currentColor">
                      <path d="M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5m14 3c0 .6-.4 1-1 1H6c-.6 0-1-.4-1-1v-1h14v1z"/>
                    </svg>'.html_safe
                  end
    
    content_tag(:div, svg_content, opts)
  end
end