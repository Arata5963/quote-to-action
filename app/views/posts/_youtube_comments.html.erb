<%# app/views/posts/_youtube_comments.html.erb %>
<%# YouTubeコメント表示セクション %>

<div id="youtube-comments-section" class="mb-8">
  <div class="flex items-center justify-between mb-4">
    <h3 class="text-base font-bold text-gray-900 flex items-center gap-2">
      <svg class="w-5 h-5 text-red-500" viewBox="0 0 24 24" fill="currentColor">
        <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
      </svg>
      YouTubeコメント
    </h3>
    <span class="text-xs text-gray-400">いいね数TOP20</span>
  </div>

  <div id="youtube-comments-container">
    <% if defined?(comments) && comments.present? %>
      <div class="space-y-4">
        <% comments.each do |comment| %>
          <div class="flex gap-3 p-3 bg-gray-50 rounded-lg">
            <% if comment[:author_image].present? %>
              <img src="<%= comment[:author_image] %>"
                   alt="<%= comment[:author] %>"
                   class="w-8 h-8 rounded-full flex-shrink-0">
            <% else %>
              <div class="w-8 h-8 rounded-full bg-gray-300 flex-shrink-0"></div>
            <% end %>
            <div class="flex-1 min-w-0">
              <div class="flex items-center gap-2 mb-1">
                <span class="text-sm font-medium text-gray-900 truncate"><%= comment[:author] %></span>
                <% if comment[:like_count] > 0 %>
                  <span class="flex items-center gap-0.5 text-xs text-gray-500">
                    <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M2 20h2c.55 0 1-.45 1-1v-9c0-.55-.45-1-1-1H2v11zm19.83-7.12c.11-.25.17-.52.17-.8V11c0-1.1-.9-2-2-2h-5.5l.92-4.65c.05-.22.02-.46-.08-.66-.23-.45-.52-.86-.88-1.22L14 2 7.59 8.41C7.21 8.79 7 9.3 7 9.83v7.84C7 18.95 8.05 20 9.34 20h8.11c.7 0 1.36-.37 1.72-.97l2.66-6.15z"/>
                    </svg>
                    <%= number_with_delimiter(comment[:like_count]) %>
                  </span>
                <% end %>
              </div>
              <p class="text-sm text-gray-700 whitespace-pre-line line-clamp-4"><%= comment[:text] %></p>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <p class="text-center text-gray-500 py-4 text-sm">コメントを取得できませんでした</p>
    <% end %>
  </div>
</div>
