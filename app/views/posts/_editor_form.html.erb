<%# app/views/posts/_editor_form.html.erb %>
<%# „Éï„É´„Çπ„ÇØ„É™„Éº„É≥„Ç®„Éá„Ç£„ÇøÂΩ¢Âºè„ÅÆÊäïÁ®ø„Éï„Ç©„Éº„É† %>

<div class="editor-fullscreen" data-controller="editor-form youtube-search clipboard"
     data-youtube-search-url-value="<%= youtube_search_posts_path %>"
     data-clipboard-url-value="<%= post.youtube_url %>">

  <%= form_with(model: post, local: true, html: { class: "editor-form" }) do |form| %>
    <%# ===== „Éò„ÉÉ„ÉÄ„Éº ===== %>
    <header class="editor-header">
      <div class="editor-header-left">
        <%= link_to posts_path, class: "editor-close-btn", data: { turbo_confirm: "Á∑®ÈõÜÂÜÖÂÆπ„ÅåÂ§±„Çè„Çå„Åæ„Åô„ÄÇÈñâ„Åò„Åæ„Åô„ÅãÔºü" } do %>
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
          </svg>
          <span>Èñâ„Åò„Çã</span>
        <% end %>
      </div>
      <div class="editor-header-right">
        <%= form.submit post.persisted? ? "Êõ¥Êñ∞„Åô„Çã" : "Ë®òÈå≤„Åô„Çã", class: "editor-submit-btn" %>
      </div>
    </header>

    <%# ===== „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ ===== %>
    <main class="editor-main">
      <div class="editor-content">

        <%# „Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫ %>
        <% if post.errors.any? %>
          <div class="editor-error">
            <svg class="w-5 h-5 text-red-500 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
            </svg>
            <div>
              <% post.errors.full_messages.each do |message| %>
                <p><%= message %></p>
              <% end %>
            </div>
          </div>
        <% end %>

        <%# ===== YouTube URLÂÖ•Âäõ ===== %>
        <section class="editor-section">
          <div class="editor-youtube-input">
            <label class="editor-label">
              <svg class="w-5 h-5 text-red-500" viewBox="0 0 24 24" fill="currentColor">
                <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
              </svg>
              YouTubeÂãïÁîª
            </label>

            <%# „É¢„Éº„ÉâÂàá„ÇäÊõø„Åà %>
            <div class="editor-youtube-tabs">
              <button type="button"
                      data-action="click->youtube-search#toggleMode"
                      data-mode="url"
                      data-youtube-search-target="urlTab"
                      class="editor-youtube-tab active">
                URL„ÇíË≤º„Çä‰ªò„Åë
              </button>
              <button type="button"
                      data-action="click->youtube-search#toggleMode"
                      data-mode="search"
                      data-youtube-search-target="searchTab"
                      class="editor-youtube-tab">
                „Çø„Ç§„Éà„É´„ÅßÊ§úÁ¥¢
              </button>
            </div>

            <%# URLÂÖ•Âäõ %>
            <div data-youtube-search-target="urlPanel">
              <%= form.url_field :youtube_url,
                    placeholder: "https://www.youtube.com/watch?v=...",
                    required: true,
                    data: {
                      clipboard_target: "input",
                      youtube_search_target: "urlField",
                      action: "focus->clipboard#checkClipboard input->youtube-search#fetchVideoInfo"
                    },
                    class: "editor-input" %>
              <p class="editor-hint">„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Åã„ÇâYouTube URL„ÅåËá™ÂãïÊ§úÂá∫„Åï„Çå„Åæ„Åô</p>
            </div>

            <%# Ê§úÁ¥¢„Éë„Éç„É´ %>
            <div data-youtube-search-target="searchPanel" class="hidden">
              <div class="relative">
                <input type="text"
                       placeholder="ÂãïÁîª„Çø„Ç§„Éà„É´„ÇíÂÖ•Âäõ„Åó„Å¶Ê§úÁ¥¢..."
                       data-youtube-search-target="input"
                       data-action="input->youtube-search#search"
                       class="editor-input">
                <div class="absolute right-3 top-1/2 -translate-y-1/2">
                  <svg class="w-5 h-5 text-gray-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                  </svg>
                </div>
              </div>
              <div data-youtube-search-target="results" class="hidden editor-search-results"></div>
            </div>

            <%# „Çµ„É†„Éç„Ç§„É´„Éó„É¨„Éì„É•„Éº %>
            <div data-youtube-search-target="preview" class="editor-video-preview hidden">
              <img data-youtube-search-target="thumbnail" src="" alt="" class="editor-video-thumbnail">
              <div class="editor-video-info">
                <p data-youtube-search-target="title" class="editor-video-title"></p>
                <p data-youtube-search-target="channel" class="editor-video-channel"></p>
              </div>
            </div>
          </div>
        </section>

        <%# ===== „Ç¢„Ç¶„Éà„Éó„ÉÉ„ÉàÂÖ•Âäõ ===== %>
        <section class="editor-section editor-output-section">
          <%# „Çø„Éñ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥Ôºà„É°„É¢/ÂºïÁî®/„Ç¢„ÇØ„Ç∑„Éß„É≥/„Éñ„É≠„Ç∞Ôºâ %>
          <div class="editor-tabs">
            <button type="button"
                    data-editor-form-target="tab"
                    data-tab="keyPoint"
                    data-action="click->editor-form#switchTab"
                    class="editor-tab editor-tab-active">
              <span class="editor-tab-icon">üìù</span>
              <span class="editor-tab-label">„É°„É¢</span>
            </button>
            <button type="button"
                    data-editor-form-target="tab"
                    data-tab="quote"
                    data-action="click->editor-form#switchTab"
                    class="editor-tab editor-tab-inactive">
              <span class="editor-tab-icon">üí¨</span>
              <span class="editor-tab-label">ÂºïÁî®</span>
            </button>
            <button type="button"
                    data-editor-form-target="tab"
                    data-tab="action"
                    data-action="click->editor-form#switchTab"
                    class="editor-tab editor-tab-inactive">
              <span class="editor-tab-icon">üéØ</span>
              <span class="editor-tab-label">„Ç¢„ÇØ„Ç∑„Éß„É≥</span>
            </button>
            <button type="button"
                    data-editor-form-target="tab"
                    data-tab="blog"
                    data-action="click->editor-form#switchTab"
                    class="editor-tab editor-tab-inactive">
              <span class="editor-tab-icon">üì∞</span>
              <span class="editor-tab-label">„Éñ„É≠„Ç∞</span>
            </button>
          </div>

          <%# „Ç®„Éá„Ç£„Çø„Ç®„É™„Ç¢Ôºà„Çø„Éñ„ÅßÂàá„ÇäÊõø„ÅàÔºâ %>
          <div class="editor-area">
            <%# „É°„É¢„Ç®„Éá„Ç£„Çø %>
            <div data-editor-form-target="editor" data-editor-type="keyPoint" class="editor-panel">
              <textarea data-editor-form-target="keyPointContent"
                        data-action="keydown->editor-form#handleKeydown"
                        placeholder="„Åì„ÅÆÂãïÁîª„ÅßÂ≠¶„Çì„Å†„Åì„Å®„ÇíÂÖ•Âäõ...

- ÁÆáÊù°Êõ∏„Åç„ÇÇ‰Ωø„Åà„Åæ„Åô
- „Éû„Éº„ÇØ„ÉÄ„Ç¶„É≥Ë®òÊ≥ï„Å´ÂØæÂøú‰∫àÂÆö"
                        rows="14"
                        class="editor-textarea editor-textarea-large"></textarea>
              <div class="editor-panel-footer">
                <span class="text-xs text-gray-400">Cmd/Ctrl + Enter „Åß‰øùÂ≠ò</span>
                <button type="button"
                        data-action="click->editor-form#saveEntry"
                        class="editor-save-btn">
                  ‰øùÂ≠ò
                </button>
              </div>
            </div>

            <%# ÂºïÁî®„Ç®„Éá„Ç£„Çø %>
            <div data-editor-form-target="editor" data-editor-type="quote" class="editor-panel" style="display: none;">
              <textarea data-editor-form-target="quoteContent"
                        data-action="keydown->editor-form#handleKeydown"
                        placeholder="ÂãïÁîª„ÅÆ‰∏≠„ÅßÂç∞Ë±°„Å´ÊÆã„Å£„ÅüË®ÄËëâ„ÇíÂÖ•Âäõ..."
                        rows="5"
                        class="editor-textarea editor-textarea-quote"></textarea>
              <div class="editor-panel-footer">
                <span class="text-xs text-gray-400">Cmd/Ctrl + Enter „Åß‰øùÂ≠ò</span>
                <button type="button"
                        data-action="click->editor-form#saveEntry"
                        class="editor-save-btn">
                  ‰øùÂ≠ò
                </button>
              </div>
            </div>

            <%# „Ç¢„ÇØ„Ç∑„Éß„É≥„Ç®„Éá„Ç£„Çø %>
            <div data-editor-form-target="editor" data-editor-type="action" class="editor-panel" style="display: none;">
              <textarea data-editor-form-target="actionContent"
                        data-action="keydown->editor-form#handleKeydown"
                        placeholder="„Åì„ÅÆÂãïÁîª„ÇíË¶ã„Å¶„ÄÅÂÖ∑‰ΩìÁöÑ„Å´‰Ωï„Çí„Åó„Åæ„Åô„ÅãÔºü"
                        rows="4"
                        class="editor-textarea"></textarea>
              <div class="editor-action-deadline">
                <label class="text-sm text-gray-600">ÊúüÊó•Ôºà‰ªªÊÑèÔºâ</label>
                <input type="date"
                       data-editor-form-target="actionDeadline"
                       class="editor-date-input">
              </div>
              <div class="editor-panel-footer">
                <span class="text-xs text-gray-400">Cmd/Ctrl + Enter „Åß‰øùÂ≠ò</span>
                <button type="button"
                        data-action="click->editor-form#saveEntry"
                        class="editor-save-btn">
                  ‰øùÂ≠ò
                </button>
              </div>
            </div>

            <%# „Éñ„É≠„Ç∞„Ç®„Éá„Ç£„Çø %>
            <div data-editor-form-target="editor" data-editor-type="blog" class="editor-panel" style="display: none;" data-controller="blog-editor">
              <%# „Çø„Ç§„Éà„É´ %>
              <div style="margin-bottom: 12px;">
                <input type="text"
                       name="blog_entry[title]"
                       data-editor-form-target="blogTitle"
                       placeholder="„Éñ„É≠„Ç∞„ÅÆ„Çø„Ç§„Éà„É´..."
                       style="width: 100%; padding: 12px; font-size: 16px; font-weight: 500; border: 1px solid #e5e7eb; border-radius: 8px;">
              </div>

              <%# Á∑®ÈõÜ/„Éó„É¨„Éì„É•„ÉºÂàá„ÇäÊõø„Åà %>
              <div style="display: flex; gap: 0; border-bottom: 1px solid #e5e7eb; margin-bottom: 12px;">
                <button type="button"
                        data-blog-editor-target="editTab"
                        data-action="blog-editor#showEdit"
                        class="active-tab"
                        style="padding: 8px 16px; font-size: 13px; background: none; border: none; cursor: pointer; position: relative;">
                  ‚úèÔ∏è Á∑®ÈõÜ
                </button>
                <button type="button"
                        data-blog-editor-target="previewTab"
                        data-action="blog-editor#showPreview"
                        class="inactive-tab"
                        style="padding: 8px 16px; font-size: 13px; background: none; border: none; cursor: pointer; position: relative;">
                  üëÅÔ∏è „Éó„É¨„Éì„É•„Éº
                </button>
              </div>

              <%# Êú¨Êñá„Ç®„Éá„Ç£„Çø %>
              <div data-blog-editor-target="editor">
                <textarea name="blog_entry[content]"
                          data-editor-form-target="blogContent"
                          data-blog-editor-target="input"
                          placeholder="MarkdownË®òÊ≥ï„Åå‰Ωø„Åà„Åæ„Åô...

## Ë¶ãÂá∫„Åó
- ÁÆáÊù°Êõ∏„Åç
**Â§™Â≠ó** „ÇÑ *Êñú‰Ωì* „ÇÇ‰Ωø„Åà„Åæ„Åô"
                          rows="12"
                          class="editor-textarea"
                          style="font-family: monospace;"></textarea>
              </div>

              <%# „Éó„É¨„Éì„É•„Éº %>
              <div data-blog-editor-target="preview"
                   class="hidden markdown-preview"
                   style="min-height: 250px; padding: 16px; border: 1px solid #e5e7eb; border-radius: 8px; background: #fafafa;">
              </div>

              <%# „Éï„ÉÉ„Çø„Éº %>
              <div class="editor-panel-footer" style="justify-content: space-between;">
                <label style="display: flex; align-items: center; gap: 8px; font-size: 13px; color: #6b7280;">
                  <input type="checkbox"
                         name="blog_entry[publish]"
                         value="true"
                         data-editor-form-target="blogPublish"
                         style="width: 14px; height: 14px;">
                  ÂÖ¨Èñã„Åô„Çã
                </label>
                <button type="button"
                        data-action="click->editor-form#saveEntry"
                        class="editor-save-btn">
                  ‰øùÂ≠ò
                </button>
              </div>
            </div>
          </div>

          <%# ‰øùÂ≠òÊ∏à„Åø„Ç¢„Ç¶„Éà„Éó„ÉÉ„Éà‰∏ÄË¶ß %>
          <div class="editor-saved-section">
            <div class="editor-saved-header hidden">
              <span>‰øùÂ≠òÊ∏à„Åø</span>
              <span data-editor-form-target="savedCount" class="editor-saved-count">0</span>
            </div>
            <div data-editor-form-target="savedList" class="editor-saved-list">
              <div class="text-center py-8 text-gray-400">
                <p>„Åæ„Å†„Ç¢„Ç¶„Éà„Éó„ÉÉ„Éà„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>
                <p class="text-sm mt-1">‰∏ä„ÅÆ„Ç®„Éá„Ç£„Çø„ÅßÂÖ•Âäõ„Åó„Å¶„Äå‰øùÂ≠ò„Äç„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
              </div>
            </div>
          </div>

          <%# ÈùûË°®Á§∫„Éï„Ç£„Éº„É´„ÉâÔºà„Éï„Ç©„Éº„É†ÈÄÅ‰ø°Áî®Ôºâ %>
          <div data-editor-form-target="hiddenEntries"></div>
        </section>

      </div>
    </main>
  <% end %>
</div>
