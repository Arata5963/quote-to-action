<%= turbo_stream.replace "ai-summary-container" do %>
  <div id="ai-summary-container" style="margin-bottom: 24px;">
    <div data-controller="disclosure" data-disclosure-open-value="true" style="background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%); border-radius: 12px; border: 1px solid #ddd6fe; overflow: hidden;">
      <%# トグルヘッダー %>
      <button type="button"
              data-action="click->disclosure#toggle"
              style="width: 100%; display: flex; align-items: center; justify-content: space-between; padding: 16px 20px; background: transparent; border: none; cursor: pointer; text-align: left;">
        <div style="display: flex; align-items: center; gap: 8px;">
          <svg style="width: 20px; height: 20px; color: #7c3aed;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
          </svg>
          <span style="font-size: 14px; font-weight: 600; color: #5b21b6;">AI学習ガイド</span>
        </div>
        <svg data-disclosure-target="icon" style="width: 20px; height: 20px; color: #7c3aed; transition: transform 0.2s ease; transform: rotate(180deg);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
        </svg>
      </button>
      <%# コンテンツ（生成直後は開いた状態） %>
      <div data-disclosure-target="content" style="display: block; padding: 0 20px 20px 20px; border-top: 1px solid #ddd6fe;">
        <div class="markdown-content" style="font-size: 14px; color: #374151; line-height: 1.8; padding-top: 16px;">
          <%= markdown_to_html(@summary) %>
        </div>
      </div>
    </div>
  </div>
<% end %>
