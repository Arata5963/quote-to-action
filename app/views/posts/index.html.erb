<%# app/views/posts/index.html.erb %>
<% content_for :title, "ÊäïÁ®ø‰∏ÄË¶ß" %>
<div class="max-w-7xl mx-auto px-4 py-8">
  <%# „Éö„Éº„Ç∏„Éò„ÉÉ„ÉÄ„ÉºÈÉ®ÂàÜ %>
  <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-8">
    <h1 class="text-2xl sm:text-3xl font-bold text-gray-900">„Åç„Å£„Åã„Åë‰∏ÄË¶ß</h1>
    <%= link_to "Êñ∞„Åó„ÅÑ„Åç„Å£„Åã„Åë„ÇíÊäïÁ®ø", new_post_path,
          class: "bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition-colors text-center" %>
  </div>
  
  <%# ÊäïÁ®ø„Åå„Å™„ÅÑÂ†¥Âêà„ÅÆË°®Á§∫ %>
  <% if @posts.empty? %>
    <div class="text-center py-12">
      <div class="text-gray-500 text-lg mb-4">„Åæ„Å†ÊäïÁ®ø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>
      <%= link_to "ÊúÄÂàù„ÅÆ„Åç„Å£„Åã„Åë„ÇíÊäïÁ®ø„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ", new_post_path,
            class: "bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-md transition-colors" %>
    </div>
  <% else %>
    <%# ÊäïÁ®ø‰∏ÄË¶ßË°®Á§∫ - „É¨„Çπ„Éù„É≥„Ç∑„Éñ„Ç∞„É™„ÉÉ„Éâ %>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6">
      <% @posts.each do |post| %>
        <%# „Ç´„Éº„ÉâÊú¨‰Ωì %>
        <%= link_to post, class: "group relative block bg-black rounded-lg overflow-hidden" do %>
          
          <%# üÜï ÁîªÂÉèË°®Á§∫„É≠„Ç∏„ÉÉ„ÇØ %>
          <% if post.image.present? %>
            <%# „Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åï„Çå„ÅüÁîªÂÉè„ÇíË°®Á§∫ %>
            <img
              alt="ÊäïÁ®øÁîªÂÉè"
              src="<%= post.image.url %>"
              class="absolute inset-0 h-full w-full object-cover opacity-75 transition-opacity group-hover:opacity-85"
            />
          <% else %>
            <%# ÁîªÂÉè„Åå„Å™„ÅÑÂ†¥Âêà„ÅØ„Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥ËÉåÊôØ %>
            <div class="absolute inset-0 h-full w-full bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 opacity-80"></div>
          <% end %>
          
          <%# „Ç™„Éº„Éê„Éº„É¨„Ç§„Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥Ôºà„ÉÜ„Ç≠„Çπ„Éà„ÅÆÂèØË™≠ÊÄßÂêë‰∏äÔºâ %>
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-black/20"></div>
          
          <div class="relative p-4 lg:p-6 min-h-[250px] sm:min-h-[300px] flex flex-col justify-between">
            <%# ‰∏äÈÉ®„Ç≥„É≥„ÉÜ„É≥„ÉÑ: ÈÅîÊàêÂõûÊï∞ + „Ç¢„ÇØ„Ç∑„Éß„É≥„Éó„É©„É≥ %>
            <div>
              <div class="flex items-center justify-between mb-2">
                <span class="text-xs sm:text-sm text-yellow-300 font-semibold bg-black/30 px-2 py-1 rounded-full">
                  ÈÅîÊàê <%= post.achievements.where(user_id: current_user.id).count %> Âõû
                </span>
                
                <%# üÜï ÁîªÂÉèÊúâÁÑ°„Ç§„É≥„Ç∏„Ç±„Éº„Çø„Éº %>
                <% if post.image.present? %>
                  <span class="text-xs text-green-300 bg-black/30 px-2 py-1 rounded-full">
                    <svg class="inline w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"></path>
                    </svg>
                    ÁîªÂÉè
                  </span>
                <% end %>
              </div>
              
              <h3 class="text-lg sm:text-xl font-bold text-white leading-tight drop-shadow-lg">
                <%= post.action_plan.truncate(50) %>
              </h3>
            </div>
            
            <%# ‰∏ãÈÉ®„Ç≥„É≥„ÉÜ„É≥„ÉÑ: „Åç„Å£„Åã„Åë %>
            <div class="mt-auto">
              <p class="text-xs sm:text-sm text-white opacity-90 leading-relaxed drop-shadow">
                <%= post.trigger_content.truncate(80) %>
              </p>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  <% end %>
</div>