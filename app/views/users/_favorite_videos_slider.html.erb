<%# app/views/users/_favorite_videos_slider.html.erb %>
<div class="favorite-videos-slider" data-controller="video-slider" data-video-slider-total-value="<%= videos.size %>">
  <div class="flex gap-3">
    <%# 前へボタン（左側） %>
    <% if videos.size > 1 %>
      <button type="button"
              class="self-center flex-shrink-0 p-2 rounded-full bg-primary/10 hover:bg-primary/20 text-primary/60 hover:text-primary transition-colors disabled:opacity-30 disabled:cursor-not-allowed"
              data-action="click->video-slider#prev"
              data-video-slider-target="prevBtn">
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
          <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
        </svg>
      </button>
    <% end %>

    <%# 中央コンテンツ（画像・タイトル・インジケーター） %>
    <div class="flex-1 min-w-0">
      <%# スライド %>
      <div class="relative aspect-video rounded-xl overflow-hidden bg-primary/5">
        <% videos.each_with_index do |video, index| %>
          <div class="video-slide absolute inset-0 <%= index == 0 ? '' : 'hidden' %>"
               data-video-slider-target="slide"
               data-slide-index="<%= index %>">
            <%= link_to video.youtube_url, target: "_blank", rel: "noopener noreferrer", class: "block w-full h-full" do %>
              <%= image_tag video.youtube_thumbnail_url(size: :hqdefault),
                            alt: video.youtube_title || "動画サムネイル",
                            class: "w-full h-full object-cover" %>
            <% end %>
          </div>
        <% end %>
      </div>

      <%# 動画情報 %>
      <% videos.each_with_index do |video, index| %>
        <div class="mt-3 <%= index == 0 ? '' : 'hidden' %>"
             data-video-slider-target="info"
             data-info-index="<%= index %>">
          <h3 class="font-medium text-primary line-clamp-2">
            <%= video.youtube_title.presence || "タイトル取得中..." %>
          </h3>
          <p class="text-sm text-primary/60 mt-1">
            <%= video.youtube_channel_name.presence || "チャンネル名取得中..." %>
          </p>
        </div>
      <% end %>

      <%# インジケーター %>
      <% if videos.size > 1 %>
        <div class="flex justify-center gap-2 mt-3">
          <% videos.each_with_index do |_, index| %>
            <button type="button"
                    class="w-2 h-2 rounded-full transition-colors <%= index == 0 ? 'bg-accent' : 'bg-primary/20' %>"
                    data-action="click->video-slider#goTo"
                    data-video-slider-target="indicator"
                    data-slide-index="<%= index %>">
            </button>
          <% end %>
        </div>
      <% end %>
    </div>

    <%# 次へボタン（右側） %>
    <% if videos.size > 1 %>
      <button type="button"
              class="self-center flex-shrink-0 p-2 rounded-full bg-primary/10 hover:bg-primary/20 text-primary/60 hover:text-primary transition-colors disabled:opacity-30 disabled:cursor-not-allowed"
              data-action="click->video-slider#next"
              data-video-slider-target="nextBtn">
        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
          <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
        </svg>
      </button>
    <% end %>
  </div>
</div>
